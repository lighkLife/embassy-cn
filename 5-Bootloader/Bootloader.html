<!doctype html>
<html class="no-js" lang="zh_CN">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="next" title="例子" href="../6-Examples/index.html" /><link rel="prev" title="引导程序" href="index.html" />

    <meta name="generator" content="sphinx-4.3.2, furo 2022.06.21"/>
        <title>Bootloader - embassy-cn 0.1.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">embassy-cn 0.1.0 文档</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">embassy-cn 0.1.0 文档</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=搜索 name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../0-Embassy/Embassy.html">Embassy</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../1-Getting-started/index.html">快速开始</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../1-Getting-started/Basic-application.html">A basic Embassy application</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../2-Bare-metal-to-async/index.html">在裸机上异步</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../2-Bare-metal-to-async/Bare-metal-to-async.html">From bare metal to async Rust</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-Executor/index.html">执行器 Executor</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-Executor/executor.html">执行器 Executor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../4-HAL/index.html">硬件抽象层 HAL</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../4-HAL/nRF.html">Embassy nRF HAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../4-HAL/STM32.html">Embassy STM32 HAL</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">引导程序</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Bootloader</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../6-Examples/index.html">例子</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../6-Examples/Examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../7-Developer/index.html">开发者文档</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../7-Developer/Developer-STM32.html">Developer Documentation: STM32</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="bootloader">
<h1>Bootloader<a class="headerlink" href="#bootloader" title="永久链接至标题">#</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">embassy-boot</span></code> a lightweight bootloader supporting firmware application upgrades in a power-fail-safe way, with trial boots and rollbacks.</p>
<p>The bootloader can be used either as a library or be flashed directly if you are happy with the default configuration and capabilities.</p>
<p>By design, the bootloader does not provide any network capabilities. Networking capabilities for fetching new firmware can be provided by the user application, using the bootloader as a library for updating the firmware, or by using the bootloader as a library and adding this capability yourself.</p>
<p>The bootloader supports both internal and external flash by relying on the <code class="docutils literal notranslate"><span class="pre">embedded-storage</span></code> traits. The bootloader optionally supports the verification of firmware that has been digitally signed (recommended).</p>
<div class="section" id="hardware-support">
<h2>Hardware support<a class="headerlink" href="#hardware-support" title="永久链接至标题">#</a></h2>
<p>The bootloader supports</p>
<ul class="simple">
<li><p>nRF52 with and without softdevice</p></li>
<li><p>STM32 L4, WB, WL, L1, L0, F3, F7 and H7</p></li>
<li><p>Raspberry Pi: RP2040</p></li>
</ul>
<p>In general, the bootloader works on any platform that implements the <code class="docutils literal notranslate"><span class="pre">embedded-storage</span></code> traits for its internal flash, but may require custom initialization code to work.</p>
</div>
<div class="section" id="design">
<h2>Design<a class="headerlink" href="#design" title="永久链接至标题">#</a></h2>
<p><img alt="Bootloader flash layout" src="https://embassy.dev/book/dev/_images/bootloader_flash.png" /></p>
<p>The bootloader divides the storage into 4 main partitions, configurable when creating the bootloader instance or via linker scripts:</p>
<ul>
<li><p>BOOTLOADER - Where the bootloader is placed. The bootloader itself consumes about 8kB of flash, but if you need to debug it and have space available, increasing this to 24kB will allow you to run the bootloader with probe-rs.</p></li>
<li><p>ACTIVE - Where the main application is placed. The bootloader will attempt to load the application at the start of this partition. This partition is only written to by the bootloader. The size required for this partition depends on the size of your application.</p></li>
<li><p>DFU - Where the application-to-be-swapped is placed. This partition is written to by the application. This partition must be at least 1 page bigger than the ACTIVE partition, since the swap algorithm uses the extra space to ensure power safe copy of data:</p>
<p>Partition Sizedfu= Partition Sizeactive+ Page Sizeactive</p>
<p>All values are specified in bytes.</p>
</li>
<li><p>BOOTLOADER STATE - Where the bootloader stores the current state describing if the active and dfu partitions need to be swapped. When the new firmware has been written to the DFU partition, a magic field is written to instruct the bootloader that the partitions should be swapped. This partition must be able to store a magic field as well as the partition swap progress. The partition size given by:</p>
<p>Partition Sizestate = Write Sizestate + (2 × Partition Sizeactive / Page Sizeactive)</p>
<p>All values are specified in bytes.</p>
</li>
</ul>
<p>The partitions for ACTIVE (+BOOTLOADER), DFU and BOOTLOADER_STATE may be placed in separate flash. The page size used by the bootloader is determined by the lowest common multiple of the ACTIVE and DFU page sizes. The BOOTLOADER_STATE partition must be big enough to store one word per page in the ACTIVE and DFU partitions combined.</p>
<p>The bootloader has a platform-agnostic part, which implements the power fail safe swapping algorithm given the boundaries set by the partitions. The platform-specific part is a minimal shim that provides additional functionality such as watchdogs or supporting the nRF52 softdevice.</p>
<div class="section" id="firmwareupdater">
<h3><a class="reference external" href="https://embassy.dev/book/dev/bootloader.html#_firmwareupdater">FirmwareUpdater</a><a class="headerlink" href="#firmwareupdater" title="永久链接至标题">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">FirmwareUpdater</span></code> is an object for conveniently flashing firmware to the DFU partition and subsequently marking it as being ready for swapping with the active partition on the next reset. Its principle methods are <code class="docutils literal notranslate"><span class="pre">write_firmware</span></code>, which is called once per the size of the flash “write block” (typically 4KiB), and <code class="docutils literal notranslate"><span class="pre">mark_updated</span></code>, which is the final call.</p>
</div>
<div class="section" id="verification">
<h3><a class="reference external" href="https://embassy.dev/book/dev/bootloader.html#_verification">Verification</a><a class="headerlink" href="#verification" title="永久链接至标题">#</a></h3>
<p>The bootloader supports the verification of firmware that has been flashed to the DFU partition. Verification requires that firmware has been signed digitally using <a class="reference external" href="https://ed25519.cr.yp.to/"><code class="docutils literal notranslate"><span class="pre">ed25519</span></code></a> signatures. With verification enabled, the <code class="docutils literal notranslate"><span class="pre">FirmwareUpdater::verify_and_mark_updated</span></code> method is called in place of <code class="docutils literal notranslate"><span class="pre">mark_updated</span></code>. A public key and signature are required, along with the actual length of the firmware that has been flashed. If verification fails then the firmware will not be marked as updated and therefore be rejected.</p>
<p>Signatures are normally conveyed with the firmware to be updated and not written to flash. How signatures are provided is a firmware responsibility.</p>
<p>To enable verification use either the <code class="docutils literal notranslate"><span class="pre">ed25519-dalek</span></code> or <code class="docutils literal notranslate"><span class="pre">ed25519-salty</span></code> features when depending on the <code class="docutils literal notranslate"><span class="pre">embassy-boot</span></code> crate. We recommend <code class="docutils literal notranslate"><span class="pre">ed25519-salty</span></code> at this time due to its small size.</p>
<div class="section" id="tips-on-keys-and-signing-with-ed25519">
<h4><a class="reference external" href="https://embassy.dev/book/dev/bootloader.html#_tips_on_keys_and_signing_with_ed25519">Tips on keys and signing with ed25519</a><a class="headerlink" href="#tips-on-keys-and-signing-with-ed25519" title="永久链接至标题">#</a></h4>
<p>Ed25519 is a public key signature system where you are responsible for keeping the private key secure. We recommend embedding the <strong>public</strong> key in your program so that it can be easily passed to <code class="docutils literal notranslate"><span class="pre">verify_and_mark_updated</span></code>. An example declaration of the public key in your firmware:</p>
<div class="highlight-rust notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="n">PUBLIC_SIGNING_KEY</span>: <span class="kp">&amp;</span><span class="p">[</span><span class="kt">u8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="fm">include_bytes!</span><span class="p">(</span><span class="s">&quot;key.pub&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>Signatures are often conveyed along with firmware by appending them.</p>
<p>Ed25519 keys can be generated by a variety of tools. We recommend <a class="reference external" href="https://man.openbsd.org/signify"><code class="docutils literal notranslate"><span class="pre">signify</span></code></a> as it is in wide use to sign and verify OpenBSD distributions, and is straightforward to use.</p>
<p>The following set of Bash commands can be used to generate public and private keys on Unix platforms, and also generate a local <code class="docutils literal notranslate"><span class="pre">key.pub</span></code> file with the <code class="docutils literal notranslate"><span class="pre">signify</span></code> file headers removed. Declare a <code class="docutils literal notranslate"><span class="pre">SECRETS_DIR</span></code> environment variable in a secure location.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>signify<span class="w"> </span>-G<span class="w"> </span>-n<span class="w"> </span>-p<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.pub<span class="w"> </span>-s<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.sec
tail<span class="w"> </span>-n1<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.pub<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>-i<span class="w"> </span>-<span class="w"> </span><span class="p">|</span><span class="w"> </span>dd<span class="w"> </span><span class="nv">ibs</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">skip</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>&gt;<span class="w"> </span>key.pub
chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.sec
<span class="nb">export</span><span class="w"> </span><span class="nv">SECRET_SIGNING_KEY</span><span class="o">=</span><span class="k">$(</span>tail<span class="w"> </span>-n1<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.sec<span class="k">)</span>
</pre></div>
</div>
<p>Then, to sign your firmware given a declaration of <code class="docutils literal notranslate"><span class="pre">FIRMWARE_DIR</span></code> and a firmware filename of <code class="docutils literal notranslate"><span class="pre">myfirmware</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>shasum<span class="w"> </span>-a<span class="w"> </span><span class="m">512</span><span class="w"> </span>-b<span class="w"> </span><span class="nv">$FIRMWARE_DIR</span>/myfirmware<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt
cat<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>dd<span class="w"> </span><span class="nv">ibs</span><span class="o">=</span><span class="m">128</span><span class="w"> </span><span class="nv">count</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xxd<span class="w"> </span>-p<span class="w"> </span>-r<span class="w"> </span>&gt;<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt
signify<span class="w"> </span>-S<span class="w"> </span>-s<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/key.sec<span class="w"> </span>-m<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt<span class="w"> </span>-x<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt.sig
cp<span class="w"> </span><span class="nv">$FIRMWARE_DIR</span>/myfirmware<span class="w"> </span><span class="nv">$FIRMWARE_DIR</span>/myfirmware+signed
tail<span class="w"> </span>-n1<span class="w"> </span><span class="nv">$SECRETS_DIR</span>/message.txt.sig<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w"> </span>-i<span class="w"> </span>-<span class="w"> </span><span class="p">|</span><span class="w"> </span>dd<span class="w"> </span><span class="nv">ibs</span><span class="o">=</span><span class="m">10</span><span class="w"> </span><span class="nv">skip</span><span class="o">=</span><span class="m">1</span><span class="w"> </span>&gt;&gt;<span class="w"> </span><span class="nv">$FIRMWARE_DIR</span>/myfirmware+signed
</pre></div>
</div>
<p>Remember, guard the <code class="docutils literal notranslate"><span class="pre">$SECRETS_DIR/key.sec</span></code> key as compromising it means that another party can sign your firmware.</p>
</div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../6-Examples/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">例子</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">引导程序</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, lighk
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            目录
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Bootloader</a><ul>
<li><a class="reference internal" href="#hardware-support">Hardware support</a></li>
<li><a class="reference internal" href="#design">Design</a><ul>
<li><a class="reference internal" href="#firmwareupdater">FirmwareUpdater</a></li>
<li><a class="reference internal" href="#verification">Verification</a><ul>
<li><a class="reference internal" href="#tips-on-keys-and-signing-with-ed25519">Tips on keys and signing with ed25519</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/translations.js"></script>
    </body>
</html>